---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import { getCollection } from 'astro:content';

const allPosts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
).slice(0, 5);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
		<style>
			.container {
				max-width: 70rem;
				margin: 0 auto;
				padding: 0 1rem;
			}
			.hero {
				display: flex;
				flex-direction: column;
				align-items: center;
				gap: 1.75rem;
				margin-bottom: 2.5rem;
			}
			.avatar {
				width: 7rem;
				height: 7rem;
				border-radius: 9999px;
				border: 1px solid rgba(var(--gray), 0.2);
				padding: 0.25rem;
				object-fit: cover;
			}
			.hero-content {
				display: flex;
				flex-direction: column;
				align-items: center;
				gap: 1rem;
			}
			.hero-title {
				font-size: 1.875rem;
				font-weight: 500;
				margin: 0;
			}
			.hero-description {
				text-align: center;
				color: rgb(var(--muted-foreground));
				margin: 0;
			}
			.section {
				margin-bottom: 2.5rem;
				padding: 2rem;
				border-radius: 1rem;
				border: 1px solid rgba(var(--border), 0.5);
				transition: all 0.3s;
			}
			.section:hover {
				box-shadow: 0 4px 12px rgba(var(--black), 0.05);
			}
			.section-about {
				background: linear-gradient(135deg, rgba(74, 144, 226, 0.05) 0%, rgba(74, 144, 226, 0.02) 100%);
			}
			.section-posts {
				background: linear-gradient(135deg, rgba(139, 92, 246, 0.05) 0%, rgba(139, 92, 246, 0.02) 100%);
			}
			:global(html.dark) .section-about {
				background: linear-gradient(135deg, rgba(74, 144, 226, 0.08) 0%, rgba(74, 144, 226, 0.03) 100%);
			}
			:global(html.dark) .section-posts {
				background: linear-gradient(135deg, rgba(139, 92, 246, 0.08) 0%, rgba(139, 92, 246, 0.03) 100%);
			}
			.section-title {
				font-size: 1.5rem;
				font-weight: 500;
				margin-bottom: 1rem;
				color: rgb(var(--black));
			}
			.section-content {
				color: rgb(var(--muted-foreground));
			}
			.posts-list {
				list-style: none;
				padding: 0;
				margin: 0;
				display: flex;
				flex-direction: column;
				gap: 1rem;
			}
			.post-item {
				display: flex;
				flex-direction: column;
				gap: 0.5rem;
			}
			.post-link {
				text-decoration: none;
				color: rgb(var(--black));
				font-weight: 500;
				transition: color 0.2s;
			}
			.post-link:hover {
				color: var(--accent);
			}
			.post-date {
				font-size: 0.875rem;
				color: rgb(var(--muted-foreground));
			}
			.btn {
				display: inline-flex;
				align-items: center;
				gap: 0.5rem;
				padding: 0.5rem 1rem;
				background-color: transparent;
				border: 1px solid rgba(var(--border));
				border-radius: 0.375rem;
				color: rgb(var(--black));
				text-decoration: none;
				font-weight: 500;
				transition: all 0.2s;
				margin-top: 1rem;
			}
			.btn:hover {
				background-color: rgba(var(--muted));
			}
			@media (min-width: 768px) {
				.content-wrapper {
					width: 80%;
					margin: 0 auto;
				}
			}
			@media (min-width: 1024px) {
				.content-wrapper {
					width: 83.333333%;
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<Header />
			<main class="flex w-full flex-col items-center">
				<section class="animate hero" id="content-header">
					<img
						src="/favicon/favicon.ico"
						alt="Profile"
						class="avatar"
						loading="eager"
					/>
					<div class="hero-content">
						<h1 class="hero-title">{SITE_TITLE}</h1>
						<p class="hero-description">{SITE_DESCRIPTION}</p>
					</div>
				</section>

				<div id="content" class="animate flex flex-col content-wrapper" style="gap: 2.5rem;">
					<section class="section section-about">
						<h2 class="section-title">About</h2>
						<div class="section-content">
							<p>Welcome to my personal blog. I share thoughts, ideas, and projects here.</p>
							<p>Exploring technology, creativity, and continuous learning.</p>
						</div>
					</section>

					{allPosts.length > 0 && (
						<section class="section section-posts">
							<h2 class="section-title">Recent Posts</h2>
							<ul class="posts-list">
								{allPosts.map((post) => (
									<li class="post-item">
										<a href={`/blog/${post.id}/`} class="post-link">
											{post.data.title}
										</a>
										<time class="post-date" datetime={post.data.pubDate.toISOString()}>
											{post.data.pubDate.toLocaleDateString('en-US', {
												year: 'numeric',
												month: 'short',
												day: 'numeric'
											})}
										</time>
									</li>
								))}
							</ul>
							<a href="/blog" class="btn">
								More posts
								<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
								</svg>
							</a>
						</section>
					)}
				</div>
			</main>
			<Footer />
		</div>
	</body>
</html>
