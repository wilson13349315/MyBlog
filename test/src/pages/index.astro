---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import { getCollection } from 'astro:content';

const allPosts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
).slice(0, 5);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
		<style>
			.container {
				max-width: 70rem;
				margin: 0 auto;
				padding: 0 1rem;
			}
			.hero {
				display: flex;
				flex-direction: column;
				align-items: center;
				gap: 1.75rem;
				margin-bottom: 2.5rem;
			}
			.avatar {
				width: 7rem;
				height: 7rem;
				border-radius: 9999px;
				border: 1px solid rgba(var(--gray), 0.2);
				padding: 0.25rem;
				object-fit: cover;
			}
			.hero-content {
				display: flex;
				flex-direction: column;
				align-items: center;
				gap: 1rem;
			}
			.hero-title {
				font-size: 1.875rem;
				font-weight: 500;
				margin: 0;
			}
			.hero-description {
				text-align: center;
				color: rgb(var(--muted-foreground));
				margin: 0;
			}
			.section {
				margin-bottom: 2.5rem;
				border-radius: 1rem;
				border: 1px solid rgba(var(--border), 0.5);
				transition: all 0.3s;
			}
			.section-about {
				padding: 2rem;
			}
			.section-posts {
				padding: 2rem 2rem 1.5rem;
			}
			.section:hover {
				box-shadow: 0 4px 12px rgba(var(--black), 0.05);
			}
			.section-about {
				background: linear-gradient(135deg, rgba(74, 144, 226, 0.05) 0%, rgba(74, 144, 226, 0.02) 100%);
			}
			:global(html.dark) .section-about {
				background: linear-gradient(135deg, rgba(74, 144, 226, 0.08) 0%, rgba(74, 144, 226, 0.03) 100%);
			}
			.section-title {
				font-size: 1.5rem;
				font-weight: 500;
				margin-bottom: 1rem;
				color: rgb(var(--black));
			}
			.section-content {
				color: rgb(var(--muted-foreground));
			}
			.posts-list {
				list-style: none;
				padding: 0;
				margin: 0 1rem;
				display: flex;
				flex-direction: column;
				gap: 0.375rem;
			}
			.post-item {
				width: 100%;
			}
			.post-link {
				display: block;
				width: 100%;
				position: relative;
				padding: 0.625rem 1.25rem;
				border-radius: 0.75rem;
				border: 1px solid rgba(var(--border), 0.5);
				background-color: transparent;
				text-decoration: none;
				transition: all 0.3s ease-in-out;
			}
			.post-link:hover {
				background-color: rgba(var(--muted), 1);
				color: var(--accent);
			}
			.post-link-content {
				position: relative;
				z-index: 1;
				display: flex;
				flex-direction: column;
				gap: 0.25rem;
			}
			@media (min-width: 640px) {
				.post-link-content {
					flex-direction: row;
					align-items: center;
				}
			}
			.post-date {
				min-width: 95px;
				font-size: 0.75rem;
				color: rgb(var(--muted-foreground));
			}
			.post-title-wrapper {
				display: flex;
				justify-content: space-between;
				flex-grow: 1;
				align-items: center;
			}
			.post-title {
				color: rgb(var(--black));
				transition: color 0.3s;
			}
			.post-link:hover .post-title {
				color: var(--accent);
			}
			.post-arrow {
				margin-left: 0.25rem;
				stroke: rgb(var(--muted-foreground));
				transition: all 0.3s ease-in-out;
			}
			.post-link:hover .post-arrow {
				stroke: var(--accent);
			}
			.post-arrow line {
				transform: translateX(1rem) scaleX(0);
				transition: all 0.3s ease-in-out;
			}
			.post-link:hover .post-arrow line {
				transform: translateX(0.25rem) scaleX(1);
			}
			.post-arrow polyline {
				transform: translateX(0);
				transition: all 0.3s ease-in-out;
			}
			.post-link:hover .post-arrow polyline {
				transform: translateX(0.25rem);
			}
			.btn {
				display: inline-flex;
				align-items: center;
				gap: 0.5rem;
				padding: 0.625rem 1.25rem;
				background-color: transparent;
				border: none;
				color: var(--accent);
				text-decoration: none;
				font-weight: 500;
				font-size: 0.875rem;
				transition: all 0.2s;
				margin: 1.5rem 1rem 0.5rem;
			}
			.btn:hover {
				gap: 0.75rem;
			}
			.btn svg {
				transition: transform 0.2s;
			}
			.btn:hover svg {
				transform: translateX(0.125rem);
			}
			@media (min-width: 768px) {
				.content-wrapper {
					width: 80%;
					margin: 0 auto;
				}
			}
			@media (min-width: 1024px) {
				.content-wrapper {
					width: 83.333333%;
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<Header />
			<main class="flex w-full flex-col items-center">
				<section class="animate hero" id="content-header">
					<img
						src="/favicon/favicon.ico"
						alt="Profile"
						class="avatar"
						loading="eager"
					/>
					<div class="hero-content">
						<h1 class="hero-title">{SITE_TITLE}</h1>
						<p class="hero-description">{SITE_DESCRIPTION}</p>
					</div>
				</section>

				<div id="content" class="animate flex flex-col content-wrapper" style="gap: 2.5rem;">
					<section class="section section-about">
						<h2 class="section-title">About</h2>
						<div class="section-content">
							<p>Welcome to my personal blog. I share thoughts, ideas, and projects here.</p>
							<p>Exploring technology, creativity, and continuous learning.</p>
						</div>
					</section>

					{allPosts.length > 0 && (
						<section class="section section-posts">
							<h2 class="section-title">Recent Posts</h2>
							<ul class="posts-list">
								{allPosts.map((post) => (
									<li class="post-item">
										<a href={`/blog/${post.id}/`} class="post-link">
											<div class="post-link-content">
												<time class="post-date" datetime={post.data.pubDate.toISOString()}>
													{post.data.pubDate.toLocaleDateString('en-US', {
														year: 'numeric',
														month: 'short',
														day: 'numeric'
													})}
												</time>
												<div class="post-title-wrapper">
													<div class="post-title">{post.data.title}</div>
													<svg
														xmlns="http://www.w3.org/2000/svg"
														width="16"
														height="16"
														viewBox="0 0 24 24"
														fill="none"
														stroke-width="2.5"
														stroke-linecap="round"
														stroke-linejoin="round"
														class="post-arrow"
													>
														<line x1="5" y1="12" x2="19" y2="12"></line>
														<polyline points="12 5 19 12 12 19"></polyline>
													</svg>
												</div>
											</div>
										</a>
									</li>
								))}
							</ul>
							<a href="/blog" class="btn">
								More posts â†’
							</a>
						</section>
					)}
				</div>
			</main>
			<Footer />
		</div>
	</body>
</html>
